{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "            交易日期    证券代码   证券简称      前收      今收   升跌(%)           成交金额(元)  \\\n",
      "0     2021-07-23       1   平安银行   20.38   20.10   -1.37  1,461,467,511.79   \n",
      "1     2021-07-23       2  万  科Ａ   23.21   23.11   -0.43  1,205,101,189.00   \n",
      "2     2021-07-23       4   国华网安   24.45   24.26   -0.78    271,400,900.23   \n",
      "3     2021-07-23       5   ST星源    2.08    2.15    3.37     62,169,442.39   \n",
      "4     2021-07-23       6   深振业Ａ    4.73    4.70   -0.63     37,134,134.58   \n",
      "...          ...     ...    ...     ...     ...     ...               ...   \n",
      "2498  2021-07-23  301029   N怡合达   14.14  109.80  676.52  2,761,991,648.71   \n",
      "2499  2021-07-23  301030    C仕净   27.17   29.16    7.32    594,356,882.29   \n",
      "2500  2021-07-23  301031   中熔电气  148.70  140.49   -5.52    403,283,694.72   \n",
      "2501  2021-07-23  301032    C新柴   14.38   12.61  -12.31    324,649,753.13   \n",
      "2502  2021-07-23  301039   中集车辆   12.32   11.80   -4.22    298,411,074.90   \n",
      "\n",
      "         市盈率  \n",
      "0      14.36  \n",
      "1       6.47  \n",
      "2      61.97  \n",
      "3       0.00  \n",
      "4       7.34  \n",
      "...      ...  \n",
      "2498  161.95  \n",
      "2499   63.25  \n",
      "2500  168.05  \n",
      "2501   32.42  \n",
      "2502   21.03  \n",
      "\n",
      "[2503 rows x 8 columns]\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>交易日期</th>\n",
       "      <th>证券代码</th>\n",
       "      <th>证券简称</th>\n",
       "      <th>前收</th>\n",
       "      <th>今收</th>\n",
       "      <th>升跌(%)</th>\n",
       "      <th>成交金额(元)</th>\n",
       "      <th>市盈率</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>1</td>\n",
       "      <td>平安银行</td>\n",
       "      <td>20.38</td>\n",
       "      <td>20.10</td>\n",
       "      <td>-1.37</td>\n",
       "      <td>1,461,467,511.79</td>\n",
       "      <td>14.36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>2</td>\n",
       "      <td>万  科Ａ</td>\n",
       "      <td>23.21</td>\n",
       "      <td>23.11</td>\n",
       "      <td>-0.43</td>\n",
       "      <td>1,205,101,189.00</td>\n",
       "      <td>6.47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>4</td>\n",
       "      <td>国华网安</td>\n",
       "      <td>24.45</td>\n",
       "      <td>24.26</td>\n",
       "      <td>-0.78</td>\n",
       "      <td>271,400,900.23</td>\n",
       "      <td>61.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>5</td>\n",
       "      <td>ST星源</td>\n",
       "      <td>2.08</td>\n",
       "      <td>2.15</td>\n",
       "      <td>3.37</td>\n",
       "      <td>62,169,442.39</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>6</td>\n",
       "      <td>深振业Ａ</td>\n",
       "      <td>4.73</td>\n",
       "      <td>4.70</td>\n",
       "      <td>-0.63</td>\n",
       "      <td>37,134,134.58</td>\n",
       "      <td>7.34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>7</td>\n",
       "      <td>*ST全新</td>\n",
       "      <td>4.73</td>\n",
       "      <td>4.57</td>\n",
       "      <td>-3.38</td>\n",
       "      <td>30,741,997.28</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>8</td>\n",
       "      <td>神州高铁</td>\n",
       "      <td>2.18</td>\n",
       "      <td>2.17</td>\n",
       "      <td>-0.46</td>\n",
       "      <td>21,112,891.21</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>9</td>\n",
       "      <td>中国宝安</td>\n",
       "      <td>24.62</td>\n",
       "      <td>23.18</td>\n",
       "      <td>-5.85</td>\n",
       "      <td>2,645,971,910.71</td>\n",
       "      <td>90.34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>10</td>\n",
       "      <td>美丽生态</td>\n",
       "      <td>3.93</td>\n",
       "      <td>4.02</td>\n",
       "      <td>2.29</td>\n",
       "      <td>48,686,539.99</td>\n",
       "      <td>82.72</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>11</td>\n",
       "      <td>深物业A</td>\n",
       "      <td>12.74</td>\n",
       "      <td>12.29</td>\n",
       "      <td>-3.53</td>\n",
       "      <td>134,686,058.38</td>\n",
       "      <td>9.17</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         交易日期  证券代码   证券简称     前收     今收  升跌(%)           成交金额(元)    市盈率\n",
       "0  2021-07-23     1   平安银行  20.38  20.10  -1.37  1,461,467,511.79  14.36\n",
       "1  2021-07-23     2  万  科Ａ  23.21  23.11  -0.43  1,205,101,189.00   6.47\n",
       "2  2021-07-23     4   国华网安  24.45  24.26  -0.78    271,400,900.23  61.97\n",
       "3  2021-07-23     5   ST星源   2.08   2.15   3.37     62,169,442.39   0.00\n",
       "4  2021-07-23     6   深振业Ａ   4.73   4.70  -0.63     37,134,134.58   7.34\n",
       "5  2021-07-23     7  *ST全新   4.73   4.57  -3.38     30,741,997.28   0.00\n",
       "6  2021-07-23     8   神州高铁   2.18   2.17  -0.46     21,112,891.21   0.00\n",
       "7  2021-07-23     9   中国宝安  24.62  23.18  -5.85  2,645,971,910.71  90.34\n",
       "8  2021-07-23    10   美丽生态   3.93   4.02   2.29     48,686,539.99  82.72\n",
       "9  2021-07-23    11   深物业A  12.74  12.29  -3.53    134,686,058.38   9.17"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import QUANTAXIS as QA\n",
    "import pandas as pd\n",
    "df = pd.read_excel ('/Users/yuhanzhang/Desktop/股票行情.xlsx')\n",
    "print(df)\n",
    "df.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1. 今收>前收"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Result dataframe :\n",
      "             交易日期    证券代码  证券简称     前收      今收   升跌(%)           成交金额(元)  \\\n",
      "3     2021-07-23       5  ST星源   2.08    2.15    3.37     62,169,442.39   \n",
      "8     2021-07-23      10  美丽生态   3.93    4.02    2.29     48,686,539.99   \n",
      "12    2021-07-23      16  深康佳Ａ   6.18    6.23    0.81    125,342,805.37   \n",
      "30    2021-07-23      38   深大通   9.98   10.10    1.20     35,096,751.20   \n",
      "32    2021-07-23      40  东旭蓝天   2.99    3.03    1.34    160,422,330.58   \n",
      "...          ...     ...   ...    ...     ...     ...               ...   \n",
      "2488  2021-07-23  301018  申菱环境  21.80   22.49    3.17    203,758,122.93   \n",
      "2491  2021-07-23  301021  英诺激光  46.11   46.80    1.50    337,752,075.71   \n",
      "2495  2021-07-23  301026  浩通科技  69.43   69.82    0.56    403,095,173.66   \n",
      "2498  2021-07-23  301029  N怡合达  14.14  109.80  676.52  2,761,991,648.71   \n",
      "2499  2021-07-23  301030   C仕净  27.17   29.16    7.32    594,356,882.29   \n",
      "\n",
      "         市盈率  \n",
      "3       0.00  \n",
      "8      82.72  \n",
      "12     31.40  \n",
      "30     66.40  \n",
      "32      0.00  \n",
      "...      ...  \n",
      "2488   43.33  \n",
      "2491  108.33  \n",
      "2495   65.25  \n",
      "2498  161.95  \n",
      "2499   63.25  \n",
      "\n",
      "[650 rows x 8 columns]\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>交易日期</th>\n",
       "      <th>证券代码</th>\n",
       "      <th>证券简称</th>\n",
       "      <th>前收</th>\n",
       "      <th>今收</th>\n",
       "      <th>升跌(%)</th>\n",
       "      <th>成交金额(元)</th>\n",
       "      <th>市盈率</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>5</td>\n",
       "      <td>ST星源</td>\n",
       "      <td>2.08</td>\n",
       "      <td>2.15</td>\n",
       "      <td>3.37</td>\n",
       "      <td>62,169,442.39</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>10</td>\n",
       "      <td>美丽生态</td>\n",
       "      <td>3.93</td>\n",
       "      <td>4.02</td>\n",
       "      <td>2.29</td>\n",
       "      <td>48,686,539.99</td>\n",
       "      <td>82.72</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>16</td>\n",
       "      <td>深康佳Ａ</td>\n",
       "      <td>6.18</td>\n",
       "      <td>6.23</td>\n",
       "      <td>0.81</td>\n",
       "      <td>125,342,805.37</td>\n",
       "      <td>31.40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>38</td>\n",
       "      <td>深大通</td>\n",
       "      <td>9.98</td>\n",
       "      <td>10.10</td>\n",
       "      <td>1.20</td>\n",
       "      <td>35,096,751.20</td>\n",
       "      <td>66.40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>2021-07-23</td>\n",
       "      <td>40</td>\n",
       "      <td>东旭蓝天</td>\n",
       "      <td>2.99</td>\n",
       "      <td>3.03</td>\n",
       "      <td>1.34</td>\n",
       "      <td>160,422,330.58</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          交易日期  证券代码  证券简称    前收     今收  升跌(%)         成交金额(元)    市盈率\n",
       "3   2021-07-23     5  ST星源  2.08   2.15   3.37   62,169,442.39   0.00\n",
       "8   2021-07-23    10  美丽生态  3.93   4.02   2.29   48,686,539.99  82.72\n",
       "12  2021-07-23    16  深康佳Ａ  6.18   6.23   0.81  125,342,805.37  31.40\n",
       "30  2021-07-23    38   深大通  9.98  10.10   1.20   35,096,751.20  66.40\n",
       "32  2021-07-23    40  东旭蓝天  2.99   3.03   1.34  160,422,330.58   0.00"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_df = df.loc[df['今收'] > df['前收']]\n",
    "print('\\nResult dataframe :\\n', new_df)\n",
    "new_df.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2. 成交量>平均"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0       1,461,467,511.79\n",
      "1       1,205,101,189.00\n",
      "2         271,400,900.23\n",
      "3          62,169,442.39\n",
      "4          37,134,134.58\n",
      "              ...       \n",
      "2498    2,761,991,648.71\n",
      "2499      594,356,882.29\n",
      "2500      403,283,694.72\n",
      "2501      324,649,753.13\n",
      "2502      298,411,074.90\n",
      "Name: 成交金额(元), Length: 2503, dtype: object\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "证券代码     123670.852177\n",
       "前收           21.412881\n",
       "今收           21.146420\n",
       "升跌(%)        -0.924315\n",
       "dtype: float64"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(df['成交金额(元)'])\n",
    "df.mean()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
